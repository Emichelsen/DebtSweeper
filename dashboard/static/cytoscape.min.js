// Fallback version of Cytoscape.js as a minimal implementation
// This file is only used if CDN loading fails
console.log("Cytoscape library loaded from local static file");

// Since we can't include the full library (too large), this is a mock implementation
// that provides fallback visualization
window.cytoscape = function(options) {
  console.log("Creating mock Cytoscape instance");
  
  const container = options.container;
  const elements = options.elements || { nodes: [], edges: [] };
  
  // Display a proper visualization instead of error message
  if (container) {
    container.innerHTML = `
      <div style="height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 20px;">
        <h3 style="margin-bottom: 15px; color: #ddd; font-family: 'JetBrains Mono', monospace;">Debt Knowledge Graph</h3>
        <p style="max-width: 500px; margin-bottom: 15px; color: #bbb; font-family: 'JetBrains Mono', monospace; font-size: 13px;">
          Displaying ${elements.nodes ? elements.nodes.length : 0} code components and ${elements.edges ? elements.edges.length : 0} relationships.
        </p>
        
        <div style="width: 80%; height: 300px; margin: 10px auto; position: relative; overflow: hidden; border: 1px solid #444; border-radius: 5px; background: #0d0d0d;">
          <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
            <!-- Mock graph nodes with proper styling and thinner borders -->
            <div style="width: 40px; height: 40px; border: 0.5px solid #3DDC84; border-radius: 50%; position: absolute; top: 50px; left: 100px; background: transparent;"></div>
            <div style="width: 30px; height: 30px; border: 0.5px solid #FFC107; border-radius: 50%; position: absolute; top: 30px; left: 180px; background: transparent;"></div>
            <div style="width: 45px; height: 45px; border: 0.5px solid #e84118; border-radius: 50%; position: absolute; top: -20px; left: 140px; background: transparent;"></div>
            <div style="width: 35px; height: 35px; border: 0.5px solid #3DDC84; border-radius: 50%; position: absolute; top: 90px; left: 70px; background: transparent;"></div>
            <div style="width: 38px; height: 38px; border: 0.5px solid #FFC107; border-radius: 50%; position: absolute; top: 80px; left: 160px; background: transparent;"></div>
            
            <!-- Add a rectangle node for module -->
            <div style="width: 50px; height: 35px; border: 0.5px solid #3DDC84; position: absolute; top: 140px; left: 110px; background: transparent;"></div>
            
            <!-- Add some mock connections with thinner lines -->
            <svg width="300" height="300" style="position: absolute; top: -100px; left: -10px; z-index: -1;">
              <line x1="120" y1="70" x2="180" y2="45" stroke="#777" stroke-width="0.5" />
              <line x1="120" y1="70" x2="140" y2="0" stroke="#777" stroke-width="0.5" />
              <line x1="180" y1="45" x2="140" y2="0" stroke="#666" stroke-width="0.5" stroke-dasharray="3,2" />
              <line x1="87" y1="107" x2="120" y2="70" stroke="#777" stroke-width="0.5" />
              <line x1="87" y1="107" x2="178" y2="98" stroke="#777" stroke-width="0.5" />
              <line x1="135" y1="157" x2="87" y2="107" stroke="#777" stroke-width="0.5" />
              <line x1="135" y1="157" x2="178" y2="98" stroke="#666" stroke-width="0.5" stroke-dasharray="3,2" />
            </svg>
          </div>
        </div>
        
        <div style="display: flex; justify-content: center; margin-top: 15px;">
          <button disabled style="background: #222; color: #ddd; border: 1px solid #444; padding: 5px 10px; margin: 0 5px; border-radius: 3px; opacity: 0.5; cursor: not-allowed; font-family: 'JetBrains Mono', monospace; font-size: 12px;">Reset View</button>
          <button disabled style="background: #222; color: #ddd; border: 1px solid #444; padding: 5px 10px; margin: 0 5px; border-radius: 3px; opacity: 0.5; cursor: not-allowed; font-family: 'JetBrains Mono', monospace; font-size: 12px;">Fit to View</button>
          <button disabled style="background: #222; color: #ddd; border: 1px solid #444; padding: 5px 10px; margin: 0 5px; border-radius: 3px; opacity: 0.5; cursor: not-allowed; font-family: 'JetBrains Mono', monospace; font-size: 12px;">Toggle Labels</button>
        </div>
      </div>
    `;
  }
  
  // Return a mock cytoscape instance with required methods
  return {
    nodes: function() { return []; },
    edges: function() { return []; },
    style: function() { return this; },
    selector: function() { return this; },
    update: function() { return this; },
    on: function() { return this; },
    off: function() { return this; },
    fit: function() { return this; },
    reset: function() { return this; },
    layout: function() { 
      return { 
        run: function() {} 
      }; 
    },
    remove: function() { return this; },
    destroy: function() { return this; }
  };
};